<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Consolidated Roster</title>
<style>
  :root{
    --border:#e5e7eb; --ink:#22303a; --muted:#62707c;
    --panel:#f7f8fa; --radius:12px; --shadow:0 6px 18px rgba(0,0,0,.06);
  }
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--ink);margin:24px}
  .bar{display:flex;flex-wrap:wrap;gap:8px;align-items:center;margin-bottom:14px}
  .bar h1{font-size:1.15rem;margin:0 12px 0 0}
  .btn{border:1px solid var(--border);background:#fff;border-radius:10px;padding:8px 12px;cursor:pointer}
  .btn:hover{background:var(--panel)}
  .datebox{border:1px solid var(--border);border-radius:10px;padding:8px 10px;background:#fff}
  .grid{overflow:auto;border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow)}
  table{border-collapse:separate;border-spacing:0;width:100%;min-width:760px;background:#fff}
  thead th{position:sticky;top:0;background:#fff;border-bottom:1px solid var(--border);font-weight:600}
  th,td{padding:12px 14px;border-right:1px solid var(--border)}
  th:last-child,td:last-child{border-right:0}
  tbody tr:not(:last-child) td, thead tr th{border-bottom:1px solid var(--border)}
  .staff{white-space:nowrap;background:var(--panel);font-weight:600}
  .shift{display:inline-block;padding:6px 10px;border-radius:10px;background:#eef5ff}
  .morning{background:#eaf2ff}
  .afternoon{background:#e9f7ee}
  .weekend{background:#fff1e6}
  .off{color:var(--muted)}
  .sub{display:block;font-size:.85rem;color:var(--muted);margin-top:2px}
  .today{outline:2px solid #c9defc; outline-offset:-2px; border-radius:8px}
</style>
</head>
<body>
  <div class="bar">
    <h1 id="range">Week</h1>
    <button class="btn" id="prevWeek">◀ Prev week</button>
    <button class="btn" id="thisWeek">Today’s week</button>
    <button class="btn" id="nextWeek">Next week ▶</button>
    <input class="datebox" type="date" id="jumpDate" />
  </div>

  <div class="grid">
    <table id="roster">
      <thead>
        <tr id="headerRow">
          <th class="staff">Staff</th>
          <!-- day headers injected here -->
        </tr>
      </thead>
      <tbody id="body">
        <!-- rows injected here -->
      </tbody>
    </table>
  </div>

<script>
  // ——— Helpers ———
  const AUS_TZ = 'Australia/Adelaide'; // you can change if needed

  function startOfWeek(date){ // Monday-start
    const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));
    const dow = (d.getUTCDay() + 6) % 7; // Mon=0..Sun=6
    d.setUTCDate(d.getUTCDate() - dow);
    return d;
  }
  function addDays(d, n){ const x=new Date(d); x.setUTCDate(x.getUTCDate()+n); return x; }
  function fmtDay(d){
    const wd = d.toLocaleDateString('en-AU',{weekday:'short', timeZone:AUS_TZ}); // Mon
    const dm = d.toLocaleDateString('en-AU',{day:'numeric', month:'numeric', timeZone:AUS_TZ}); // 16/9
    return `${wd} ${dm}`;
  }
  function fmtRange(start){
    const end = addDays(start,6);
    const opts = {day:'numeric', month:'short', year:'numeric', timeZone:AUS_TZ};
    const a = start.toLocaleDateString('en-AU',opts);
    const b = end.toLocaleDateString('en-AU',opts);
    return `${a} – ${b}`;
  }
  function isSameDay(a,b){
    return a.getUTCFullYear()===b.getUTCFullYear()
      && a.getUTCMonth()===b.getUTCMonth()
      && a.getUTCDate()===b.getUTCDate();
  }

  // ——— Sample data (replace with real shifts) ———
  // Map day index 0..6 to shift strings or "Off"
  const staff = [
    { name:'Alice Johnson',   shifts:['9–17','9–17','9–17','9–17','Off','Off','Off'] },
    { name:'Ben Smith',       shifts:['12–20','12–20','Off','12–20','12–20','10–16','Off'] },
    { name:'Chris Lee',       shifts:['Off','8–16','8–16','Off','Off','Off','10–14'] },
    { name:'Diana Brown',     shifts:['7–15','7–15','7–15','7–15','Off','Off','Off'] },
  ];

  function cellClass(dow, value){
    if(value==='Off') return 'off';
    if(dow>=5) return 'shift weekend';
    const [start] = value.split('–').map(x=>x.trim());
    const hour = parseInt(start,10);
    if(hour<=9) return 'shift morning';
    return 'shift afternoon';
  }

  // ——— Render ———
  let weekAnchor = startOfWeek(new Date()); // Monday of current week (UTC base)

  function render(){
    // Header
    const headerRow = document.getElementById('headerRow');
    headerRow.innerHTML = '<th class="staff">Staff</th>';
    const todayLocal = new Date();

    for(let i=0;i<7;i++){
      const d = addDays(weekAnchor,i);
      const th = document.createElement('th');
      th.textContent = fmtDay(d);
      // highlight today's column if it’s within this week
      const localD = new Date(d.toLocaleString('en-AU',{timeZone:AUS_TZ}));
      const localToday = new Date(todayLocal.toLocaleString('en-AU',{timeZone:AUS_TZ}));
      if(isSameDay(localD, startOfWeek(localToday)) || isSameDay(localD, localToday)){
        // leave default; we’ll add highlight on cells below
      }
      headerRow.appendChild(th);
    }

    // Title
    document.getElementById('range').textContent = `Consolidated Team Roster (${fmtRange(weekAnchor)})`;

    // Body
    const tbody = document.getElementById('body');
    tbody.innerHTML = '';
    staff.forEach(s=>{
      const tr = document.createElement('tr');
      const name = document.createElement('td');
      name.className = 'staff';
      name.textContent = s.name;
      tr.appendChild(name);

      for(let i=0;i<7;i++){
        const d = addDays(weekAnchor,i);
        const td = document.createElement('td');
        const val = s.shifts[i] ?? 'Off';
        if(val==='Off'){
          td.innerHTML = '<span class="off">Off</span>';
        }else{
          const span = document.createElement('span');
          span.className = cellClass(i,val);
          span.textContent = val;
          td.appendChild(span);
        }
        // optional: subtle highlight for today's column
        const localD = new Date(d.toLocaleString('en-AU',{timeZone:AUS_TZ}));
        const localToday = new Date(new Date().toLocaleString('en-AU',{timeZone:AUS_TZ}));
        if(isSameDay(localD, localToday)) td.classList.add('today');
        tr.appendChild(td);
      }
      tbody.appendChild(tr);
    });
  }

  // ——— Controls ———
  document.getElementById('prevWeek').onclick = ()=>{ weekAnchor = addDays(weekAnchor,-7); render(); };
  document.getElementById('nextWeek').onclick = ()=>{ weekAnchor = addDays(weekAnchor, 7); render(); };
  document.getElementById('thisWeek').onclick = ()=>{ weekAnchor = startOfWeek(new Date()); render(); };
  document.getElementById('jumpDate').onchange = (e)=>{
    const d = new Date(e.target.value);
    if(!isNaN(d)) { weekAnchor = startOfWeek(d); render(); }
  };

  // init
  render();
</script>
</body>
</html>
